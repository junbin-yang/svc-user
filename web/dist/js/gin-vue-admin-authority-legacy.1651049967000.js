/*! 
 Build Time : 1651049967000 */
!function(){function e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t,a,r,n,u,l){try{var i=e[u](l),o=i.value}catch(c){return void a(c)}i.done?t(o):Promise.resolve(o).then(r,n)}function n(e){return function(){var t=this,a=arguments;return new Promise((function(n,u){var l=e.apply(t,a);function i(e){r(l,n,u,i,o,"next",e)}function o(e){r(l,n,u,i,o,"throw",e)}i(void 0)}))}}var u=document.createElement("style");u.innerHTML=".authority .el-input-number{margin-left:15px}.authority .el-input-number span{display:none}.role-box .el-tabs__content{height:calc(100vh - 72px);overflow:auto}\n",document.head.appendChild(u),System.register(["./gin-vue-admin-authority-legacy.16510499670002.js","./gin-vue-admin-menus-legacy.1651049967000.js","./gin-vue-admin-apis-legacy.1651049967000.js","./gin-vue-admin-datas-legacy.1651049967000.js","./gin-vue-admin-warningBar-legacy.1651049967000.js","../gva/gin-vue-admin-index-legacy.1651049967000.js","./gin-vue-admin-authorityBtn-legacy.1651049967000.js","./gin-vue-admin-api-legacy.16510499670002.js"],(function(e){"use strict";var a,r,u,l,i,o,c,d,s,f,v,y,h,p,m,g,b,I,w,k,x;return{setters:[function(e){a=e.g,r=e.d,u=e.c,l=e.u,i=e.a},function(e){o=e.default},function(e){c=e.default},function(e){d=e.default},function(e){s=e.W},function(e){f=e.r,v=e.b,y=e.o,h=e.c,p=e.e,m=e.d,g=e.w,b=e.l,I=e.f,w=e.i,k=e.P,x=e.j},function(){},function(){}],execute:function(){var _={class:"authority"},j={class:"gva-table-box"},C={class:"gva-btn-list"},O=w("新增角色"),N=w("设置权限"),V=w("新增子角色"),P=w("拷贝"),z=w("编辑"),R=w("删除"),D={class:"dialog-footer"},S=w("取 消"),A=w("确 定"),E={name:"Authority"};e("default",Object.assign(E,{setup:function(e){var w=f([{authorityId:"0",authorityName:"根角色"}]),E=f(!1),U=f("add"),B=f({}),q=f("新增角色"),T=f(!1),F=f(!1),H=f({}),L=f({authorityId:"",authorityName:"",parentId:"0"}),M=f({authorityId:[{required:!0,message:"请输入角色ID",trigger:"blur"},{validator:function(e,t,a){return/^[0-9]*[1-9][0-9]*$/.test(t)?a():a(new Error("请输入正整数"))},trigger:"blur"}],authorityName:[{required:!0,message:"请输入角色名",trigger:"blur"}],parentId:[{required:!0,message:"请选择请求方式",trigger:"blur"}]}),W=f(1),$=f(0),G=f(999),J=f([]),K=f({}),Q=function(){var e=n(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t({page:W.value,pageSize:G.value},K.value));case 2:0===(r=e.sent).code&&(J.value=r.data.list,$.value=r.data.total,W.value=r.data.page,G.value=r.data.pageSize);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Q();var X=function(e,t){B.value[e]=t},Y=f(null),Z=f(null),ee=f(null),te=function(e,t){var a=[Y,Z,ee];t&&a[t].value.needConfirm&&(a[t].value.enterAndNext(),a[t].value.needConfirm=!1)},ae=f(null),re=function(){ae.value&&ae.value.resetFields(),L.value={authorityId:"",authorityName:"",parentId:"0"}},ne=function(){re(),T.value=!1,F.value=!1},ue=function(){if("0"===L.value.authorityId)return x({type:"error",message:"角色id不能为0"}),!1;ae.value.validate(function(){var e=n(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=26;break}e.t0=U.value,e.next="add"===e.t0?4:"edit"===e.t0?9:"copy"===e.t0?14:24;break;case 4:return e.next=6,i(L.value);case 6:return 0===e.sent.code&&(x({type:"success",message:"添加成功!"}),Q(),ne()),e.abrupt("break",24);case 9:return e.next=11,l(L.value);case 11:return 0===e.sent.code&&(x({type:"success",message:"添加成功!"}),Q(),ne()),e.abrupt("break",24);case 14:return(a={authority:{authorityId:"string",authorityName:"string",datauthorityId:[],parentId:"string"},oldAuthorityId:0}).authority.authorityId=L.value.authorityId,a.authority.authorityName=L.value.authorityName,a.authority.parentId=L.value.parentId,a.authority.dataAuthorityId=H.value.dataAuthorityId,a.oldAuthorityId=H.value.authorityId,e.next=22,u(a);case 22:0===e.sent.code&&(x({type:"success",message:"复制成功！"}),Q());case 24:re(),T.value=!1;case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},le=function(){w.value=[{authorityId:"0",authorityName:"根角色"}],ie(J.value,w.value,!1)},ie=function e(t,a,r){L.value.authorityId=String(L.value.authorityId),t&&t.forEach((function(t){if(t.children&&t.children.length){var n={authorityId:t.authorityId,authorityName:t.authorityName,disabled:r||t.authorityId===L.value.authorityId,children:[]};e(t.children,n.children,r||t.authorityId===L.value.authorityId),a.push(n)}else{var u={authorityId:t.authorityId,authorityName:t.authorityName,disabled:r||t.authorityId===L.value.authorityId};a.push(u)}}))},oe=function(e){re(),q.value="新增角色",U.value="add",L.value.parentId=e,le(),T.value=!0};return function(e,t){var a=v("el-button"),u=v("el-table-column"),l=v("el-table"),i=v("el-cascader"),f=v("el-form-item"),F=v("el-input"),$=v("el-form"),G=v("el-dialog"),K=v("el-tab-pane"),re=v("el-tabs"),ie=v("el-drawer");return y(),h("div",_,[p(s,{title:"注：右上角头像下拉可切换角色"}),m("div",j,[m("div",C,[p(a,{size:"small",type:"primary",icon:"plus",onClick:t[0]||(t[0]=function(e){return oe("0")})},{default:g((function(){return[O]})),_:1})]),p(l,{data:J.value,"tree-props":{children:"children",hasChildren:"hasChildren"},"row-key":"authorityId",style:{width:"100%"}},{default:g((function(){return[p(u,{label:"角色ID","min-width":"180",prop:"authorityId"}),p(u,{align:"left",label:"角色名称","min-width":"180",prop:"authorityName"}),p(u,{align:"left",label:"操作",width:"460"},{default:g((function(e){return[p(a,{icon:"setting",size:"small",type:"text",onClick:function(t){return a=e.row,E.value=!0,void(B.value=a);var a}},{default:g((function(){return[N]})),_:2},1032,["onClick"]),p(a,{icon:"plus",size:"small",type:"text",onClick:function(t){return oe(e.row.authorityId)}},{default:g((function(){return[V]})),_:2},1032,["onClick"]),p(a,{icon:"copy-document",size:"small",type:"text",onClick:function(t){return function(e){for(var t in le(),q.value="拷贝角色",U.value="copy",L.value)L.value[t]=e[t];H.value=e,T.value=!0}(e.row)}},{default:g((function(){return[P]})),_:2},1032,["onClick"]),p(a,{icon:"edit",size:"small",type:"text",onClick:function(t){return function(e){for(var t in le(),q.value="编辑角色",U.value="edit",L.value)L.value[t]=e[t];le(),T.value=!0}(e.row)}},{default:g((function(){return[z]})),_:2},1032,["onClick"]),p(a,{icon:"delete",size:"small",type:"text",onClick:function(t){return a=e.row,void k.confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({authorityId:a.authorityId});case 2:0===e.sent.code&&(x({type:"success",message:"删除成功!"}),1===J.value.length&&W.value>1&&W.value--,Q());case 4:case"end":return e.stop()}}),e)})))).catch((function(){x({type:"info",message:"已取消删除"})}));var a}},{default:g((function(){return[R]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"])]),p(G,{modelValue:T.value,"onUpdate:modelValue":t[4]||(t[4]=function(e){return T.value=e}),title:q.value},{footer:g((function(){return[m("div",D,[p(a,{size:"small",onClick:ne},{default:g((function(){return[S]})),_:1}),p(a,{size:"small",type:"primary",onClick:ue},{default:g((function(){return[A]})),_:1})])]})),default:g((function(){return[p($,{ref_key:"authorityForm",ref:ae,model:L.value,rules:M.value,"label-width":"80px"},{default:g((function(){return[p(f,{label:"父级角色",prop:"parentId"},{default:g((function(){return[p(i,{modelValue:L.value.parentId,"onUpdate:modelValue":t[1]||(t[1]=function(e){return L.value.parentId=e}),style:{width:"100%"},disabled:"add"==U.value,options:w.value,props:{checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},"show-all-levels":!1,filterable:""},null,8,["modelValue","disabled","options"])]})),_:1}),p(f,{label:"角色ID",prop:"authorityId"},{default:g((function(){return[p(F,{modelValue:L.value.authorityId,"onUpdate:modelValue":t[2]||(t[2]=function(e){return L.value.authorityId=e}),disabled:"edit"==U.value,autocomplete:"off"},null,8,["modelValue","disabled"])]})),_:1}),p(f,{label:"角色姓名",prop:"authorityName"},{default:g((function(){return[p(F,{modelValue:L.value.authorityName,"onUpdate:modelValue":t[3]||(t[3]=function(e){return L.value.authorityName=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue","title"]),E.value?(y(),b(ie,{key:0,modelValue:E.value,"onUpdate:modelValue":t[5]||(t[5]=function(e){return E.value=e}),"with-header":!1,size:"40%",title:"角色配置"},{default:g((function(){return[p(re,{"before-leave":te,class:"role-box",type:"border-card"},{default:g((function(){return[p(K,{label:"角色菜单"},{default:g((function(){return[p(o,{ref_key:"menus",ref:Y,row:B.value,onChangeRow:X},null,8,["row"])]})),_:1}),p(K,{label:"角色api"},{default:g((function(){return[p(c,{ref_key:"apis",ref:Z,row:B.value,onChangeRow:X},null,8,["row"])]})),_:1}),p(K,{label:"资源权限"},{default:g((function(){return[p(d,{ref_key:"datas",ref:ee,authority:J.value,row:B.value,onChangeRow:X},null,8,["authority","row"])]})),_:1})]})),_:1})]})),_:1},8,["modelValue"])):I("",!0)])}}}))}}}))}();
