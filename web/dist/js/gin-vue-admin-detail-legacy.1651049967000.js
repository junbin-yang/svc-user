/*! 
 Build Time : 1651049967000 */
!function(){function e(e,t,a,n,r,u,l){try{var o=e[u](l),i=o.value}catch(c){return void a(c)}o.done?t(i):Promise.resolve(i).then(n,r)}function t(t){return function(){var a=this,n=arguments;return new Promise((function(r,u){var l=t.apply(a,n);function o(t){e(l,r,u,o,i,"next",t)}function i(t){e(l,r,u,o,i,"throw",t)}o(void 0)}))}}System.register(["./gin-vue-admin-app-legacy.16510499670002.js","../gva/gin-vue-admin-index-legacy.1651049967000.js","./gin-vue-admin-format-legacy.1651049967000.js","./gin-vue-admin-date-legacy.1651049967000.js","./gin-vue-admin-dictionary-legacy.1651049967000.js","./gin-vue-admin-sysDictionary-legacy.1651049967000.js"],(function(e){"use strict";var a,n,r,u,l,o,i,c,s,d,f,v,p,m,g,h,b,k,y,w,R,I;return{setters:[function(e){a=e.b,n=e.d,r=e.e,u=e.f},function(e){l=e.J,o=e.r,i=e.b,c=e.o,s=e.c,d=e.d,f=e.e,v=e.w,p=e.G,m=e.H,g=e.i,h=e.t,b=e.g,k=e.l,y=e.f,w=e.L,R=e.j},function(e){I=e.f},function(){},function(){},function(){}],execute:function(){var x={class:"gva-search-box"},V=g("查询"),_=g("重置"),S={class:"gva-table-box"},C={class:"gva-btn-list"},U=g("创建应用角色"),N=g("编辑"),z=g("绑定用户"),A={class:"gva-pagination"},D={key:0,style:{"text-align":"center"}},j={class:"dialog-footer"},O=g("取 消"),P=g("确 定"),q=g("确 定"),L={name:"RolesDetail"};e("default",Object.assign(L,{setup:function(e){var L=l(),$=o({data:[],rightValue:[],roleId:null,userIds:[]}),E=function(){var e=t(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t,a,n),$.value.userIds=t;case 2:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),K=function(){var e=t(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,w({page:1,limit:999999});case 3:200===(a=e.sent).code&&a.data.docs.forEach((function(e){t.push({key:e.ID,label:"".concat(e.NickName," - [ ").concat(e.Account," ] "),disabled:!e.Status})})),$.value.data=t;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();K();var T=o(""),F=o([]),G=function(){var e={};return T.value.getCheckedNodes().forEach((function(t){!0===t.IsLeaf&&(e[t.PCode]|=t.Value)})),console.info(e),e},H={children:"Children",label:"Name",isLeaf:"IsLeaf"},J=o([]),B=o([{value:!0,label:"启用",type:"success"},{value:!1,label:"禁用",type:"danger"}]),M=o({ID:0,AppKey:"",Name:"",Status:!1,Remark:"",RoleAuthoritys:{},Sequence:"",Other:{}}),Q=o({Name:[{required:!0,message:"请输入角色名",trigger:"blur"}],Status:[{required:!0,message:"请选择状态",trigger:"blur"}]}),W=o(1),X=o(0),Y=o(10),Z=o([]),ee=o({appId:String(L.params.id)}),te=function(){ee.value={appId:String(L.params.id)}},ae=function(){W.value=1,Y.value=10,ue()},ne=function(e){Y.value=e,ue()},re=function(e){W.value=e,ue()},ue=function(){var e=t(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t={})[ee.value.appId]=["app_key"],ee.value.name&&(t[ee.value.name]=["name"]),ee.value.desc&&(t[ee.value.desc]=["remark"]),ee.value.status&&(t[ee.value.status]=["status"]),e.next=7,a({page:W.value,limit:Y.value,search:t});case 7:200===(n=e.sent).code&&(Z.value=n.data.roles.docs,X.value=n.data.roles.total,W.value=n.data.roles.page,Y.value=n.data.roles.limit,J.value=n.data.roleAuthTree);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ue();var le=o(""),oe=o(!1),ie=function(){F.value=[],oe.value=!1,M.value={ID:0,AppKey:"",Name:"",Status:!1,Remark:"",RoleAuthoritys:{},Sequence:"",Other:{}}},ce=o(null),se=function(){var e=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ce.value.validate(function(){var e=t(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:e.t0=le.value,e.next="create"===e.t0?5:"edit"===e.t0?9:"bindUser"===e.t0?13:16;break;case 5:return e.next=7,r({AppId:String(L.params.id),Name:M.value.Name,Status:M.value.Status,Remark:M.value.Remark,Permissions:G()});case 7:return a=e.sent,e.abrupt("break",16);case 9:return e.next=11,n({AppId:String(L.params.id),Id:M.value.ID,Name:M.value.Name,Status:M.value.Status,Remark:M.value.Remark,Permissions:G()});case 11:return a=e.sent,e.abrupt("break",16);case 13:return console.info({AppId:String(L.params.id),RoleId:$.value.roleId,UserId:$.value.userIds}),a.code=200,e.abrupt("break",16);case 16:200===a.code&&(R({type:"success",message:a.message}),ie(),ue());case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=t(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({AppId:String(L.params.id),RoleId:$.value.roleId,UserId:$.value.userIds});case 2:200===(t=e.sent).code&&(R({type:"success",message:t.message}),ie(),ue());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=o(""),ve=function(e){switch(e){case"create":default:fe.value="创建角色";break;case"edit":fe.value="编辑角色";break;case"bindUser":fe.value="绑定用户"}le.value=e,oe.value=!0},pe=function(){var e=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M.value=t,F.value=M.value.Other.checkedNode,ve("edit");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=t(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$.value.rightValue=t.Other.assUserIds,$.value.roleId=t.ID,ve("bindUser");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(e,t){var a=i("el-input"),n=i("el-form-item"),r=i("el-option"),u=i("el-select"),l=i("el-button"),o=i("el-form"),w=i("el-table-column"),R=i("el-table"),L=i("el-pagination"),K=i("el-transfer"),G=i("el-tree"),ue=i("el-dialog");return c(),s("div",null,[d("div",x,[f(o,{inline:!0,model:ee.value},{default:v((function(){return[f(n,{label:"角色名"},{default:v((function(){return[f(a,{modelValue:ee.value.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return ee.value.name=e}),placeholder:"搜索条件"},null,8,["modelValue"])]})),_:1}),f(n,{label:"描述"},{default:v((function(){return[f(a,{modelValue:ee.value.desc,"onUpdate:modelValue":t[1]||(t[1]=function(e){return ee.value.desc=e}),placeholder:"搜索条件"},null,8,["modelValue"])]})),_:1}),f(n,{label:"启用状态",prop:"status"},{default:v((function(){return[f(u,{modelValue:ee.value.status,"onUpdate:modelValue":t[2]||(t[2]=function(e){return ee.value.status=e}),clearable:"",placeholder:"请选择"},{default:v((function(){return[(c(!0),s(p,null,m(B.value,(function(e){return c(),k(r,{key:e.value,label:"".concat(e.label,"(").concat(e.value,")"),value:e.value?"1":"0"},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),f(n,null,{default:v((function(){return[f(l,{size:"small",type:"primary",icon:"search",onClick:ae},{default:v((function(){return[V]})),_:1}),f(l,{size:"small",icon:"refresh",onClick:te},{default:v((function(){return[_]})),_:1})]})),_:1})]})),_:1},8,["model"])]),d("div",S,[d("div",C,[f(l,{size:"small",type:"primary",icon:"plus",onClick:t[3]||(t[3]=function(e){return ve("create")})},{default:v((function(){return[U]})),_:1})]),f(R,{ref:"multipleTable",data:Z.value,style:{width:"100%"},"tooltip-effect":"dark","row-key":"ID"},{default:v((function(){return[f(w,{type:"selection",width:"55"}),f(w,{align:"left",label:"id",prop:"ID","min-width":"60"}),f(w,{align:"left",label:"角色名",prop:"Name","min-width":"100"}),f(w,{align:"left",label:"创建日期","min-width":"120"},{default:v((function(e){return[g(h(b(I)(e.row.CreatedAt)),1)]})),_:1}),f(w,{align:"left",label:"描述",prop:"Remark","min-width":"150"}),f(w,{align:"left",label:"启用状态","min-width":"80",prop:"Status"},{default:v((function(e){return[d("div",null,h((t=e.row.Status,a=B.value.filter((function(e){return e.value===t}))[0],a&&"".concat(a.label))),1)];var t,a})),_:1}),f(w,{align:"left",label:"用户数",prop:"UserCount","min-width":"80"}),f(w,{align:"left",label:"按钮组"},{default:v((function(e){return[f(l,{icon:"edit",size:"small",type:"text",onClick:function(t){return pe(e.row)}},{default:v((function(){return[N]})),_:2},1032,["onClick"]),f(l,{icon:"setting",size:"small",type:"text",onClick:function(t){return me(e.row)}},{default:v((function(){return[z]})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"]),d("div",A,[f(L,{"current-page":W.value,"page-size":Y.value,"page-sizes":[10,30,50,100],total:X.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:re,onSizeChange:ne},null,8,["current-page","page-size","total"])])]),f(ue,{modelValue:oe.value,"onUpdate:modelValue":t[8]||(t[8]=function(e){return oe.value=e}),"before-close":ie,title:fe.value},{footer:v((function(){return[d("div",j,[f(l,{size:"small",onClick:ie},{default:v((function(){return[O]})),_:1}),"bindUser"!==le.value?(c(),k(l,{key:0,size:"small",type:"primary",onClick:se},{default:v((function(){return[P]})),_:1})):y("",!0),"bindUser"===le.value?(c(),k(l,{key:1,size:"small",type:"primary",onClick:de},{default:v((function(){return[q]})),_:1})):y("",!0)])]})),default:v((function(){return["bindUser"==le.value?(c(),s("div",D,[f(K,{modelValue:$.value.rightValue,"onUpdate:modelValue":t[4]||(t[4]=function(e){return $.value.rightValue=e}),style:{"text-align":"left",display:"inline-block"},filterable:"",titles:["未绑定","已绑定"],"button-texts":["解绑","绑定"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:$.value.data,onChange:E},{default:v((function(e){var t=e.option;return[d("span",null,h(t.label),1)]})),_:1},8,["modelValue","data"])])):y("",!0),"bindUser"!==le.value?(c(),k(o,{key:1,ref_key:"dialogForm",ref:ce,model:M.value,rules:Q.value,size:"medium","label-width":"110px"},{default:v((function(){return[f(n,{label:"名称",prop:"Name"},{default:v((function(){return[f(a,{modelValue:M.value.Name,"onUpdate:modelValue":t[5]||(t[5]=function(e){return M.value.Name=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1}),f(n,{label:"描述",prop:"Remark"},{default:v((function(){return[f(a,{modelValue:M.value.Remark,"onUpdate:modelValue":t[6]||(t[6]=function(e){return M.value.Remark=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1}),f(n,{label:"启用状态",prop:"Status"},{default:v((function(){return[f(u,{modelValue:M.value.Status,"onUpdate:modelValue":t[7]||(t[7]=function(e){return M.value.Status=e}),placeholder:"请选择",style:{width:"100%"}},{default:v((function(){return[(c(!0),s(p,null,m(B.value,(function(e){return c(),k(r,{key:e.value,label:"".concat(e.label,"(").concat(e.value,")"),value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),f(n,{label:"角色权限",prop:"Auth"},{default:v((function(){return[f(G,{ref_key:"treeRef",ref:T,data:J.value,"show-checkbox":"","default-expand-all":"","node-key":"ID","highlight-current":"",props:H,"default-checked-keys":F.value},null,8,["data","default-checked-keys"])]})),_:1})]})),_:1},8,["model","rules"])):y("",!0)]})),_:1},8,["modelValue","title"])])}}}))}}}))}();
